{
  "$schema": "http://json-schema.org/draft-07/schema",
  "$id": "blockception.minecraft.behaviour.trading",
  "type": "object",
  "title": "Minecraft trading",
  "additionalProperties": false,
  "definitions": {
    "gives": {
      "title": "Gives",
      "type": "array",
      "items": {
        "title": "Gives specification",
        "type": "object",
        "required": ["item"],
        "additionalProperties": false,
        "properties": {
          "item": {
            "type": "string",
            "title": "Item identifier",
            "description": "item identifier:[data value]"
          },
          "quantity": {
            "title": "Quantity",
            "oneOf": [
              { "type": "integer" },
              {
                "type": "object",
                "properties": {
                  "min": {
                    "title": "Min",
                    "type": "integer"
                  },
                  "max": {
                    "title": "Max",
                    "type": "integer"
                  }
                }
              }
            ]
          },
          "functions": {
            "title": "Functions",
            "type": "array",
            "items": {
              "type": "object",
              "required": ["function"],
              "allOf": [
                { 
                  "if": { "properties": { "function": { "type": "string", "const": "enchant_random_gear" } } },
                  "then": { "$ref": "../loot_tables/functions/enchant_random_gear.json" }
                },
                { 
                  "if": { "properties": { "function": { "type": "string", "const": "enchant_randomly" } } },
                  "then": { "$ref": "../loot_tables/functions/enchant_randomly.json" }
                },
                { 
                  "if": { "properties": { "function": { "type": "string", "const": "enchant_with_levels" } } },
                  "then": { "$ref": "../loot_tables/functions/enchant_with_levels.json" }
                },
                { 
                  "if": { "properties": { "function": { "type": "string", "const": "exploration_map" } } },
                  "then": { "$ref": "../loot_tables/functions/exploration_map.json"
                  }
                },
                /*{ 
                  "if": { "properties": { "function": { "type": "string", "const": "fill_container" } } }, 
                  "then": { "$ref": "../loot_tables/functions/fill_container.json" } 
                },*/
                { 
                  "if": { "properties": { "function": { "type": "string", "const": "furnace_smelt" } } },
                  "then": { "$ref": "../loot_tables/functions/furnace_smelt.json" }
                },
                { 
                  "if": { "properties": { "function": { "type": "string", "const": "looting_enchant" } } },
                  "then": { "$ref": "../loot_tables/functions/looting_enchant.json" }
                },
                { 
                  "if": { "properties": { "function": { "type": "string", "const": "random_aux_value" } } },
                  "then": { "$ref": "../loot_tables/functions/random_aux_value.json" }
                },
                { 
                  "if": { "properties": { "function": { "type": "string", "const": "random_block_state" } } },
                  "then": { "$ref": "../loot_tables/functions/random_block_state.json" }
                },
                { 
                  "if": { "properties": { "function": { "type": "string", "const": "set_actor_id" } } },
                  "then": { "$ref": "../loot_tables/functions/set_actor_id.json" }
                },
                { 
                  "if": { "properties": { "function": { "type": "string", "const": "set_banner_details" } } },
                  "then": { "$ref": "../loot_tables/functions/set_banner_details.json" }
                },
                { 
                  "if": { "properties": { "function": { "type": "string", "const": "set_book_contents" } } },
                  "then": { "$ref": "../loot_tables/functions/set_book_contents.json" }
                },
                { 
                  "if": { "properties": { "function": { "type": "string", "const": "set_count" } } },
                  "then": { "$ref": "../loot_tables/functions/set_count.json" }
                },
                { 
                  "if": { "properties": { "function": { "type": "string", "const": "set_damage" } } },
                  "then": { "$ref": "../loot_tables/functions/set_damage.json" }
                },
                { 
                  "if": { "properties": { "function": { "type": "string", "const": "set_data" } } },
                  "then": { "$ref": "../loot_tables/functions/set_data.json" }
                },
                { 
                  "if": { "properties": { "function": { "type": "string", "const": "set_data_from_color_index" } } },
                  "then": { "$ref": "../loot_tables/functions/set_data_from_color_index.json" }
                },
                { 
                  "if": { "properties": { "function": { "type": "string", "const": "set_lore" } } },
                  "then": { "$ref": "../loot_tables/functions/set_lore.json" }
                },
                { 
                  "if": { "properties": { "function": { "type": "string", "const": "set_name" } } },
                  "then": { "$ref": "../loot_tables/functions/set_name.json" }
                },
                { 
                  "if": { "properties": { "function": { "type": "string", "const": "specific_enchants" } } },
                  "then": { "$ref": "../loot_tables/functions/specific_enchants.json"
                  }
                }
              ]
            }
          }
        }
      }
    },
    "wants": {
      "title": "Wants",
      "type": "array",
      "items": {
        "title": "Wants specification",
        "type": "object",
        "required": ["item"],
        "additionalProperties": false,
        "properties": {
          "item": {
            "type": "string",
            "title": "Item identifier",
            "description": "item identifier:[data value]"
          },
          "quantity": {
            "title": "Quantity",
            "oneOf": [
              { "type": "integer" },
              {
                "type": "object",
                "properties": {
                  "min": {
                    "title": "Min",
                    "type": "integer"
                  },
                  "max": {
                    "title": "Max",
                    "type": "integer"
                  }
                }
              }
            ]
          }
        }
      }
    }
  },
  "properties": {
    "tiers": {
      "type": "array",
      "title": "Tiers",
      "items": {
        "title": "Trade specification",
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "trades": {
            "title": "Trades",
            "type": "array",
            "items": {
              "type": "object",
              "title": "Trade specification",
              "additionalProperties": false,
              "properties": {
                "wants": {
                  "$ref": "#/definitions/wants"
                },
                "gives": {
                  "$ref": "#/definitions/gives"
                }
              }
            }
          },
          "total_exp_required": {
            "title": "Total experience required",
            "type": "integer"
          },
          "groups": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "num_to_select": {
                  "type": "integer"
                },
                "trades": {
                  "title": "Trades",
                  "type": "array",
                  "items": {
                    "type": "object",
                    "title": "Trade specification",
                    "additionalProperties": false,
                    "properties": {
                      "wants": {
                        "title": "Wants",
                        "type": "array",
                        "items": {
                          "title": "Wants specification",
                          "type": "object",
                          "required": ["item"],
                          "additionalProperties": false,
                          "properties": {
                            "item": {
                              "type": "string",
                              "title": "Item identifier",
                              "description": "item identifier:[data value]"
                            },
                            "quantity": {
                              "title": "Quantity",
                              "oneOf": [
                                { "type": "integer" },
                                {
                                  "type": "object",
                                  "properties": {
                                    "min": {
                                      "title": "Min",
                                      "type": "integer"
                                    },
                                    "max": {
                                      "title": "Max",
                                      "type": "integer"
                                    }
                                  }
                                }
                              ]
                            },
                            "price_multiplier": {
                              "title": "Price multiplier",
                              "type": "number"
                            }
                          }
                        }
                      },
                      "gives": {
                        "$ref": "#/definitions/gives"
                      },
                      "trader_exp": {
                        "title": "Trader experience",
                        "type": "integer"
                      },
                      "max_uses": {
                        "title": "Max uses",
                        "type": "integer"
                      },
                      "reward_exp": {
                        "title": "Reward experience",
                        "type": "boolean"
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
